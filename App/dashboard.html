<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Pocket Investie</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        .sidebar {
            background: linear-gradient(135deg, #1a2a6c, #2a4d69);
        }
        .dashboard-card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .dashboard-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .investment-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }
        .chart-container {
            height: 250px;
        }
        @media (max-width: 640px) {
            .chart-container {
                height: 200px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans flex flex-col min-h-screen">
    <!-- Firebase Configuration -->
    <script>
        // Initialize Firebase with your config
        const firebaseConfig = {
            apiKey: "AIzaSyDQ8AejmnXU8lO1mHdMNoL8G85nmxnYn_A",
            authDomain: "pocket-investie.firebaseapp.com",
            projectId: "pocket-investie",
            storageBucket: "pocket-investie.firebasestorage.app",
            messagingSenderId: "246875262393",
            appId: "1:246875262393:web:f0468ca3f1da95f4b4fa68"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Check authentication state
        auth.onAuthStateChanged(user => {
            if (!user) {
                window.location.href = 'auth.html';
            } else {
                // User is signed in, display user info
                document.getElementById('userName').textContent = user.displayName || "Investor";
                document.getElementById('userEmail').textContent = user.email;
                
                // Fetch user data from Firestore
                db.collection("users").doc(user.uid).get().then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        document.getElementById('totalBalance').textContent = `₦${userData.balance.toLocaleString()}`;
                        document.getElementById('totalEarnings').textContent = `₦${userData.earnings.toLocaleString()}`;
                        document.getElementById('activeInvestments').textContent = userData.activeInvestments;
                    }
                });
                
                // Fetch transactions
                db.collection("transactions")
                    .where("userId", "==", user.uid)
                    .orderBy("date", "desc")
                    .limit(5)
                    .get().then(querySnapshot => {
                        const transactionsList = document.getElementById('transactionsList');
                        transactionsList.innerHTML = '';
                        
                        querySnapshot.forEach(doc => {
                            const transaction = doc.data();
                            const date = transaction.date.toDate();
                            const formattedDate = `${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()}`;
                            
                            const transactionItem = document.createElement('div');
                            transactionItem.className = 'flex justify-between items-center py-3 border-b border-gray-100';
                            transactionItem.innerHTML = `
                                <div class="flex items-center">
                                    <div class="p-2 rounded-full ${transaction.type === 'deposit' ? 'bg-green-100 text-green-600' : transaction.type === 'withdrawal' ? 'bg-red-100 text-red-600' : 'bg-blue-100 text-blue-600'}">
                                        <i class="fas ${transaction.type === 'deposit' ? 'fa-arrow-down' : transaction.type === 'withdrawal' ? 'fa-arrow-up' : 'fa-chart-line'}"></i>
                                    </div>
                                    <div class="ml-3">
                                        <div class="font-medium">${transaction.description}</div>
                                        <div class="text-sm text-gray-500">${formattedDate}</div>
                                    </div>
                                </div>
                                <div class="${transaction.type === 'deposit' ? 'text-green-600' : transaction.type === 'withdrawal' ? 'text-red-600' : 'text-blue-600'} font-medium">
                                    ${transaction.type === 'deposit' ? '+' : transaction.type === 'withdrawal' ? '-' : ''}₦${transaction.amount.toLocaleString()}
                                </div>
                            `;
                            
                            transactionsList.appendChild(transactionItem);
                        });
                    });
                
                // Fetch investments
                db.collection("investments")
                    .where("userId", "==", user.uid)
                    .where("status", "==", "active")
                    .get().then(querySnapshot => {
                        const investmentsList = document.getElementById('investmentsList');
                        investmentsList.innerHTML = '';
                        
                        if (querySnapshot.empty) {
                            investmentsList.innerHTML = '<div class="text-center py-8 text-gray-500">No active investments</div>';
                        } else {
                            querySnapshot.forEach(doc => {
                                const investment = doc.data();
                                const startDate = investment.startDate.toDate();
                                const endDate = investment.endDate.toDate();
                                const daysLeft = Math.ceil((endDate - new Date()) / (1000 * 60 * 60 * 24));
                                
                                const formattedStart = `${startDate.getDate()}/${startDate.getMonth()+1}/${startDate.getFullYear()}`;
                                const formattedEnd = `${endDate.getDate()}/${endDate.getMonth()+1}/${endDate.getFullYear()}`;
                                
                                const investmentItem = document.createElement('div');
                                investmentItem.className = 'border rounded-lg p-4 mb-4 bg-white';
                                investmentItem.innerHTML = `
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <div class="font-bold text-lg">${investment.plan} Plan</div>
                                            <div class="text-gray-600">${investment.percentage}% ROI</div>
                                        </div>
                                        <span class="investment-badge ${investment.plan.toLowerCase()} bg-opacity-20 px-2 py-1 rounded">
                                            ${investment.plan}
                                        </span>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4 mt-4">
                                        <div>
                                            <div class="text-gray-500 text-sm">Amount</div>
                                            <div class="font-medium">₦${investment.amount.toLocaleString()}</div>
                                        </div>
                                        <div>
                                            <div class="text-gray-500 text-sm">Expected Return</div>
                                            <div class="font-medium">₦${investment.expectedReturn.toLocaleString()}</div>
                                        </div>
                                        <div>
                                            <div class="text-gray-500 text-sm">Start Date</div>
                                            <div class="font-medium">${formattedStart}</div>
                                        </div>
                                        <div>
                                            <div class="text-gray-500 text-sm">End Date</div>
                                            <div class="font-medium">${formattedEnd}</div>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <div class="flex justify-between text-sm mb-1">
                                            <span>Progress</span>
                                            <span>${daysLeft} days left</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: ${(1 - (daysLeft/investment.duration)) * 100}%"></div>
                                        </div>
                                    </div>
                                `;
                                
                                investmentsList.appendChild(investmentItem);
                            });
                        }
                    });
            }
        });
        
        // Logout function
        function logout() {
            auth.signOut().then(() => {
                window.location.href = 'auth.html';
            });
        }
    </script>

    <!-- Top Navigation -->
    <nav class="bg-white shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-chart-line text-blue-600 text-2xl mr-2"></i>
                        <span class="text-xl font-bold text-gray-900">Pocket Investie</span>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="ml-3 relative">
                        <div class="flex items-center">
                            <div class="text-sm mr-3 hidden md:block">
                                <div class="font-medium text-gray-700" id="userName">Investor</div>
                                <div class="text-xs text-gray-500" id="userEmail">user@example.com</div>
                            </div>
                            <button onclick="logout()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition duration-300">
                                Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex flex-1">
        <!-- Sidebar Navigation -->
        <div class="sidebar text-white w-64 hidden md:block">
            <div class="p-6">
                <div class="flex items-center mb-10">
                    <div class="bg-gray-200 border-2 border-dashed rounded-xl w-16 h-16" />
                    <div class="ml-4">
                        <div class="font-bold text-lg" id="sidebarUserName">Investor</div>
                        <div class="text-sm text-blue-200">Premium Investor</div>
                    </div>
                </div>
                
                <nav class="space-y-2">
                    <a href="#" class="flex items-center p-3 bg-blue-700 rounded-lg">
                        <i class="fas fa-tachometer-alt mr-3"></i>
                        Dashboard
                    </a>
                    <a href="deposit.html" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-money-bill-wave mr-3"></i>
                        Deposit Funds
                    </a>
                    <a href="withdrawal.html" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-wallet mr-3"></i>
                        Withdraw Funds
                    </a>
                    <a href="invest.html" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-chart-line mr-3"></i>
                        Invest Now
                    </a>
                    <a href="profile.html" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-user mr-3"></i>
                        My Profile
                    </a>
                    <a href="#" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-history mr-3"></i>
                        Transaction History
                    </a>
                    <a href="#" class="flex items-center p-3 text-blue-100 hover:bg-blue-800 rounded-lg">
                        <i class="fas fa-question-circle mr-3"></i>
                        Support
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1">
            <!-- Mobile Navigation -->
            <div class="bg-blue-600 text-white p-4 md:hidden">
                <select onchange="window.location.href = this.value" class="w-full bg-blue-700 text-white p-2 rounded">
                    <option value="#">Dashboard</option>
                    <option value="deposit.html">Deposit Funds</option>
                    <option value="withdrawal.html">Withdraw Funds</option>
                    <option value="invest.html">Invest Now</option>
                    <option value="profile.html">My Profile</option>
                </select>
            </div>

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <!-- Dashboard Header -->
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-900">Dashboard</h1>
                    <p class="text-gray-600">Welcome back! Here's your investment summary.</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="dashboard-card bg-white rounded-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                                <i class="fas fa-wallet text-xl"></i>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">Total Balance</div>
                                <div class="text-2xl font-bold" id="totalBalance">₦0.00</div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <a href="deposit.html" class="inline-flex items-center text-blue-600 hover:text-blue-800">
                                <span>Add Funds</span>
                                <i class="fas fa-arrow-right ml-2 text-sm"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="dashboard-card bg-white rounded-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-green-100 text-green-600 mr-4">
                                <i class="fas fa-chart-line text-xl"></i>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">Total Earnings</div>
                                <div class="text-2xl font-bold" id="totalEarnings">₦0.00</div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <a href="withdrawal.html" class="inline-flex items-center text-green-600 hover:text-green-800">
                                <span>Withdraw Earnings</span>
                                <i class="fas fa-arrow-right ml-2 text-sm"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="dashboard-card bg-white rounded-lg p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-purple-100 text-purple-600 mr-4">
                                <i class="fas fa-business-time text-xl"></i>
                            </div>
                            <div>
                                <div class="text-gray-500 text-sm">Active Investments</div>
                                <div class="text-2xl font-bold" id="activeInvestments">0</div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <a href="invest.html" class="inline-flex items-center text-purple-600 hover:text-purple-800">
                                <span>Invest More</span>
                                <i class="fas fa-arrow-right ml-2 text-sm"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Charts and Investments -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <!-- Earnings Chart -->
                    <div class="dashboard-card bg-white rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-bold text-gray-900">Earnings Overview</h2>
                            <div class="text-sm text-gray-500">Last 30 Days</div>
                        </div>
                        <div class="chart-container">
                            <div class="bg-gray-200 border-2 border-dashed rounded-xl w-full h-full flex items-center justify-center text-gray-500">
                                Earnings Chart Visualization
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Investments -->
                    <div class="dashboard-card bg-white rounded-lg p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-bold text-gray-900">Active Investments</h2>
                            <a href="#" class="text-sm text-blue-600 hover:text-blue-800">View All</a>
                        </div>
                        <div id="investmentsList">
                            <div class="text-center py-8 text-gray-500">Loading investments...</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="dashboard-card bg-white rounded-lg p-6 mb-8">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-900">Recent Transactions</h2>
                        <a href="#" class="text-sm text-blue-600 hover:text-blue-800">View All</a>
                    </div>
                    <div id="transactionsList">
                        <div class="text-center py-8 text-gray-500">Loading transactions...</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <a href="deposit.html" class="dashboard-card bg-white rounded-lg p-4 text-center hover:bg-blue-50 transition">
                        <div class="text-blue-600 text-2xl mb-2">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="font-medium">Deposit</div>
                    </a>
                    <a href="withdrawal.html" class="dashboard-card bg-white rounded-lg p-4 text-center hover:bg-green-50 transition">
                        <div class="text-green-600 text-2xl mb-2">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="font-medium">Withdraw</div>
                    </a>
                    <a href="invest.html" class="dashboard-card bg-white rounded-lg p-4 text-center hover:bg-purple-50 transition">
                        <div class="text-purple-600 text-2xl mb-2">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="font-medium">Invest</div>
                    </a>
                    <a href="profile.html" class="dashboard-card bg-white rounded-lg p-4 text-center hover:bg-orange-50 transition">
                        <div class="text-orange-600 text-2xl mb-2">
                            <i class="fas fa-user-cog"></i>
                        </div>
                        <div class="font-medium">Profile</div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-chart-line text-blue-400 mr-2"></i>
                        Pocket Investie
                    </h3>
                    <p class="text-gray-400">"Invest Smart, Grow Your Wealth" - A secure Naira-based investment platform.</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Support</h4>
                    <ul class="space-y-2">
                        <li class="flex items-center">
                            <i class="fas fa-envelope text-blue-400 mr-2"></i>
                            <a href="mailto: victorexbinarysignalbot@gmail.com" class="text-gray-400 hover:text-white">support@pocketinvestie.com</a>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone text-blue-400 mr-2"></i>
                            <a href="tel:+2347062791952" class="text-gray-400 hover:text-white">+234 706 279 1952</a>
                        </li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Dashboard</a></li>
                        <li><a href="invest.html" class="text-gray-400 hover:text-white">Investment Plans</a></li>
                        <li><a href="profile.html" class="text-gray-400 hover:text-white">My Account</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">FAQs</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-6 text-sm text-gray-400 text-center">
                © 2025 Pocket Investie. founded and managed by Victorex Binary Option Traders. All rights reserved.
            </div>
        </div>
    </footer>
</body>
</html>
